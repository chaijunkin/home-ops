controllers:
  bitwarden:
    containers:
      app:
        image:
          repository: ghcr.io/larivierec/bitwarden-cli
          tag: 2024.4.1
        envFrom:
          - secretRef:
              name: bitwarden-cli
        securityContext:
          readOnlyRootFilesystem: true
        probes:
          liveness:
            enabled: true
            custom: true
            spec:
              exec:
                command:
                  [
                    "sh",
                    "-c",
                    "curl -X POST -s http://127.0.0.1:8087/sync | jq -e '.success == true'",
                  ]
              timeoutSeconds: 5
          readiness:
            enabled: false
          startup:
            enabled: false
        resources:
          requests:
            memory: 256Mi
            cpu: 100m
          limits:
            memory: 512Mi
service:
  app:
    controller: bitwarden
    ports:
      http:
        port: 8087
persistence:
  tmp:
    type: emptyDir
    globalMounts:
      - path: /tmp
